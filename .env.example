# ============================================================================
# OPAI - Variables de Entorno (Plantilla de Referencia)
# ============================================================================
#
# IMPORTANTE:
# - Este archivo es solo REFERENCIA. NO contiene valores reales.
# - Los valores reales viven en Vercel (fuente de verdad).
# - Para desarrollo local: copiar este archivo a .env.local y completar
#   con los valores reales desde Vercel.
#
# NUNCA commitear .env.local (está en .gitignore).
#
# ============================================================================

# ─── AUTENTICACIÓN (REQUERIDO) ─────────────────────────────────────────────
#
# Secret para firmar tokens JWT y cookies de sesión (Auth.js v5)
# Generar con: openssl rand -base64 32
# ⚠️ CRÍTICO: Sin esta variable, el login fallará
#
AUTH_SECRET=your-auth-secret-here-min-32-chars

# Alternativa legacy (Auth.js acepta cualquiera de las dos)
# NEXTAUTH_SECRET=same-value-as-auth-secret


# ─── BASE DE DATOS (REQUERIDO) ─────────────────────────────────────────────
#
# Connection string de PostgreSQL (Neon)
# Formato: postgresql://USER:PASSWORD@HOST/DATABASE?sslmode=require
# Obtener desde: https://console.neon.tech → Connection Details
# ⚠️ CRÍTICO: Sin esta variable, Prisma no puede conectar
#
DATABASE_URL=postgresql://user:password@host-pooler.region.neon.tech/dbname?sslmode=require

# Conexión directa (sin pooler) para migraciones de Prisma
# Neon: misma URL pero SIN "-pooler" en el hostname
# Requerido para prisma migrate deploy y db push (advisory locks no funcionan vía pooler)
# Para desarrollo local con Docker: puede ser igual a DATABASE_URL
DIRECT_DATABASE_URL=postgresql://user:password@host.region.neon.tech/dbname?sslmode=require


# ─── EMAILS (REQUERIDO para envío de emails) ──────────────────────────────
#
# API Key de Resend para envío de emails
# Obtener desde: https://resend.com/api-keys
# ⚠️ Sin esta variable, las invitaciones de usuarios y envío de presentaciones fallarán
#
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Email remitente (opcional, fallback: OPAI <opai@gard.cl>)
EMAIL_FROM=OPAI <opai@gard.cl>
EMAIL_REPLY_TO=[REDACTED]


# ─── GMAIL OAUTH (CRM) ─────────────────────────────────────────────────────
#
# Client ID/Secret para OAuth Gmail (una vez por empresa)
# Obtener desde Google Cloud Console → APIs & Services → Credentials
#
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GMAIL_REDIRECT_URI=http://localhost:3000/api/crm/gmail/callback
GMAIL_TOKEN_SECRET=


# ─── URLs DE LA APLICACIÓN (REQUERIDO) ────────────────────────────────────
#
# URL pública del sitio (para links en emails y presentaciones)
# Local: http://localhost:3000
# Producción: [REDACTED]
# ⚠️ Afecta links generados en emails y presentaciones
#
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# URL base de la app (para activation links)
# ⚠️ CRÍTICO: Sin esta variable, los links de activación de usuario no funcionarán
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Alternativa de SITE_URL (usado en algunos webhooks)
SITE_URL=http://localhost:3000


# ─── CMF / INDICADORES FINANCIEROS ────────────────────────────────────────
#
# API Key de CMF Chile para obtener UF/UTM diariamente
# Obtener desde: https://api.cmfchile.cl/
# Se usa en el cron /api/fx/sync
#
CMF_API_KEY=

# Secret para proteger el cron de Vercel (opcional, recomendado en prod)
# Generar con: openssl rand -hex 16
# Configurar en Vercel → Settings → Cron Job Protection
CRON_SECRET=


# ─── INTELIGENCIA ARTIFICIAL (configuración centralizada) ──────────────────
#
# Las API keys de proveedores AI (Anthropic, OpenAI, Google) se configuran
# desde la interfaz web: Configuración → Inteligencia Artificial.
# Se almacenan cifradas en la base de datos.
#
# Clave de cifrado para API keys de proveedores AI (AES-256-GCM).
# Generar con: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# ⚠️ REQUERIDO si se usa la configuración de IA desde la web.
#
AI_ENCRYPTION_KEY=

# ─── OPENAI (Chat Asistente IA — funciones avanzadas) ─────────────────────
#
# API Key de OpenAI usada exclusivamente por el chat asistente IA
# (tool calling, streaming, embeddings). Los demás módulos AI usan
# el proveedor configurado en Configuración → Inteligencia Artificial.
#
OPENAI_API_KEY=sk-proj-xxxxxxxxxxxx

# ─── GOOGLE MAPS (autocompletado de direcciones) ──────────────────────────
#
# API Key de Google Maps para autocompletado de direcciones en instalaciones
# Obtener desde: Google Cloud Console → APIs & Services → Credentials
# Habilitar: Places API, Maps Static API, Maps JavaScript API
#
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXX

# ─── CLOUDFLARE R2 (archivos CRM: adjuntos, negocios) ───────────────────────
#
# Almacenamiento de archivos (adjuntos de emails reenviados, documentos de negocios)
# Crear bucket en Cloudflare R2 y API Token con permisos de lectura/escritura
# Custom domain opcional (ej. files.gard.cl) para URLs públicas
#
R2_ACCOUNT_ID=
R2_ACCESS_KEY_ID=
R2_SECRET_ACCESS_KEY=
R2_BUCKET_NAME=gard-files
R2_PUBLIC_URL=[REDACTED]

# ─── INBOUND EMAIL (leads por correo reenviado) ─────────────────────────────
#
# Dirección a la que se reenvían correos para crear leads (Resend Inbound)
# Webhook: configurar en Resend → Webhooks → email.received → URL de esta app
#
INBOUND_LEADS_EMAIL=[REDACTED]

# ─── INTEGRACIONES OPCIONALES ──────────────────────────────────────────────

# Webhook de Zoho CRM (opcional, solo si se usa integración Zoho)
# Secret compartido para validar webhooks entrantes
# ZOHO_WEBHOOK_SECRET=your-shared-secret-with-zoho


# ─── ERP FINANCE (Contabilidad + Facturación) ────────────────────────────
#
# Proveedor DTE para emisión de facturas electrónicas SII
# Opciones: STUB (dev/testing), FACTO, NUBOX, BSALE
DTE_PROVIDER=STUB
DTE_API_KEY=
DTE_API_SECRET=
DTE_API_URL=https://api.facto.cl/v1
DTE_CERTIFICATE_PASSWORD=

# Proveedor bancario para conexión/reconciliación
# Opciones: MANUAL (solo CSV), FINTOC
BANK_PROVIDER=MANUAL
FINTOC_API_KEY=
FINTOC_SECRET_KEY=


# ─── VARIABLES DE SISTEMA (auto-gestionadas por Next.js/Vercel) ───────────
#
# Estas variables NO deben definirse manualmente:
# - NODE_ENV (development | production | test)
# - VERCEL_ENV (production | preview | development)
# - VERCEL_URL (auto en Vercel)
#
# ============================================================================
